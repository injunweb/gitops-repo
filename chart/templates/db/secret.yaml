{{- range $db := .Values.databases }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ $.Values.project }}-{{ $db.name }}-secret
  namespace: {{ $.Values.project }}
  annotations:
    # argocd.argoproj.io/sync-options: Validate=false,SkipDryRunOnMissingResource=true
    argocd.argoproj.io/sync-wave: "-1"
    # argocd.argoproj.io/hook: "Skip"
    argocd.argoproj.io/sync-options: Prune=false
    argocd.argoproj.io/compare-options: IgnoreExtraneous
type: Opaque
data:
  password: {{ randAlphaNum 16 | b64enc }}
immutable: true
{{- end }}
